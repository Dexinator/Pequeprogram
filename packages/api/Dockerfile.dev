# Usar una imagen base de Node.js (elige una versión LTS)
FROM node:20-alpine

# Establecer el directorio de trabajo dentro del contenedor
WORKDIR /app

# Copiar solo los archivos de manifiesto de paquetes para aprovechar el caché de capas de Docker
COPY package.json pnpm-lock.yaml* ./
# Instalar pnpm globalmente si no viene con la imagen base (algunas imágenes Node lo incluyen)
# RUN npm install -g pnpm

# Instalar dependencias usando pnpm
# Asegúrate de que pnpm esté disponible globalmente o usa npx pnpm install
RUN corepack enable && pnpm install --frozen-lockfile

# Copiar el resto del código de la aplicación (esto se sobreescribirá con el volumen en docker-compose.yml para desarrollo)
COPY . .

# Comando por defecto para ejecutar la aplicación en modo desarrollo con nodemon
# Asegúrate de que nodemon.json esté configurado o pasa la configuración aquí
CMD ["pnpm", "run", "dev"] 